Administration
==============

Zugriffsberechtigung
--------------------

Zum Schutz der in der Anwendung verwendeten persönlichen Daten
existieren verschiedene Kontroll- und Sicherungsmechanismen. Für
die korrekte Einrichtung der verschiedenen Kontrollebenen ist der
Systemadministrator verantwortlich.
 

Benutzerautorisierung
.....................

Jeder EBKuS-Anwender besitzt einen individuellen Benutzernamen
und ein geheimes Benutzerpasswort. Durch den Benutzernamen wird
der Anwender identifiziert und durch das Benutzerpasswort
verifiziert.  Das Programm EBKuS prüft Benutzername und Passwort
auf Gültigkeit.

Jeder Benutzer gehört einer Benutzergruppe an, aus der sich die
Benutzerrechte ergeben (siehe `Benutzergruppen und -rechte`_).
Das Programm prüft Benutzer und Benutzergruppe, Berechtigung für
einzelne Programmteile wie Klientenkarte, Dokumentenkarte,
Administration und Statistik bei jeder Datenanforderung.

Sessionmanagement
.................

Die EBKuS-Applikation besitzt ein Session-Management-System
(SMS). Meldet sich ein Benutzer mit einem gültigen Benutzernamen
und Benutzerpasswort am EBKuS System an (Benutzerautorisierung),
so beginnt eine Sitzung. Das SMS speichert zu jeder begonnen
Sitzung die aktuelle Zeit.  Das SMS registriert jede Aktivität
des Benutzers in der EBKuS-Applikation und aktualisiert die Zeit
der Sitzung mit der Zeit des Zugriffs. Es ist dadurch möglich,
die vergangene Zeit zwischen zwei Aktivitäten in der
EBKuS-Applikation zu bestimmen. Das SMS stellt sicher, dass die
Zeitdifferenz zwischen zwei Aktivitäten eine festgelegte
Zeitspanne nicht überschreitet. Ist das der Fall, meldet das SMS
den Benutzer automatisch vom System ab und sperrt den Zugriff auf
die EBKuS-Applikation. Der Benutzer muss sich erneut am System
anmelden, um wieder Zugriff auf die Anwendung zu erlangen.  Die
maximale Zeitspanne der Inaktivität, bevor ein Bearbeiter
ausgeloggt wird, wird vom Systemadministrator in der
Konfigurationsdatei (siehe `Konfiguration`_) der
EBKuS-Applikation mit der Variablen ``session_time`` festgelegt.
Die Sitzungszeit ist auf 120 Minuten voreingestellt.

*Sicherheitshinweis*: Um ein Höchstmaß an Sicherheit vor
unberechtigtem Zugriff zu erreichen, wird dem Benutzer empfohlen,
den Webbrowser nach Beenden der EBKuS-Applikation oder bei
Abwesenheit vom Arbeitsplatz zu schließen. Dies ist deshalb
notwendig, weil Webbrowser für den schnellen Zugriff im Internet
bereits besuchte Inhalte puffern. Dazu speichert der Webbrowser
die Historie der angezeigten Daten des zurückliegenden
Zeitrahmens. Es ist so möglich, nach dem Abmelden von der
EBKuS-Applikation in der Historie zurückzugehen und diese Daten
anzeigen zu lassen. Wird hingegen der Webbrowser geschlossen, ist
es für andere Benutzer nicht mehr möglich, die vorher angezeigten
Daten zu ändern, zu löschen oder zu aktualisieren, weil die
Historie mit dem Schließen des Browsers gelöscht wird.

Protokollierung
...............

In der EBKuS-Anwendung werden sämtliche Anfragen mit Benutzername
und IP-Adress des Benutzers sowie die aktuelle Zeit
protokolliert. Das Protokoll kann gemeinsam von zwei Benutzern
mit Protokollrecht eingesehen werden (siehe `Protokollansicht`_).


Einrichtung der Anwendung
-------------------------

Um die Klientenverwaltung in den laufenden Betrieb zu nehmen,
müssen zunächst vom Anwendungsbetreuer im Administrationsmenü
einige Eingaben gemacht werden, die wir hier einzeln beschreiben.

Für das folgende gilt: Anmelden als Administrator (Benutzername:
Admin, Passwort bei erstmaliger Anmeldung: Admin) in der
EBKuS-Login-Maske und Aufrufen des Administrationsmenüs. Als
erstes sollte der Administrator sein Passwort ändern.


Regierungsbezirk und Kreis
..........................

Eintragen der Code-Zahlen des statistischen Landesamtes für den
Regierungsbezirk und den Kreis, zu denen Ihre Beratungsstelle
gehört. Sie klicken im Administrationsmenü im Untermenü
Kategorien auf "Alle", suchen in der linken Spalte "Kategorie"
nach Regierungsbezirk und Kreis und klicken nacheinander diese
Links an, um auf derselben Seite die Tabellen für
Regierungsbezirk und Kreis zu erhalten. Sie wählen dann jeweils
bei diesen Tabellen den Button "Neu" und tragen im Formular
"Neuen Code für Regierungsbezirk bzw. Kreis anlegen" als Code die
Ziffern (Feld: Code) und als Namen den Namen für Ihren
Regierungsbezirk sowie den Kreis (Feld: Namen) ein und setzen die
Sortierziffer (Feld: sort) auf 1, damit diese Eintragungen später
als Default-Werte dem Anwender als erste angezeigt werden. Zum
Abspeichern klicken Sie auf den Button "hinzufügen". Sofern
Dienststellen aus verschiedenen Kreisen diese EBKuS-Anwendung
(URL) nutzen, tragen sie alle benötigten Kreis-Ziffern des
Statistischen Landesamtes nacheinander ein

Dienststelle
............

Ändern Sie den Namen der Dienststelle im Administrationsmenü auf
den Namen Ihrer Stelle ab, indem Sie sich als Admin anmelden und
im Administrationsmenü im Untermenü "Kategorien" auf
"Mitarbeiter" und dann bei der Tabelle "Dienststelle" in der
Spalte Code auf "A" klicken. Im aufgerufenen Formular löschen Sie
im Feld Dienststelle den vorgegebenen Eintrag und tragen den
Namen Ihrer Dienststelle ein. Zum Abspeichern klicken Sie auf
"Aktualisieren". Sollen mehrere Dienststellen (EFBen) die
Anwendung nutzen, tragen Sie diese ebenfalls ein. Dazu klicken
Sie im Administrationsmenü im Untermenü "Kategorien" auf
"Mitarbeiter" und dann bei der Tabelle "Dienststelle" auf den
Button "Neu". Tragen Sie den Namen der aufzunehmenden Stelle ein
und vergeben als Code einen Buchstaben in der Reihenfolge B,C,D
.....Z für die jeweilige Dienststelle. Zum Abspeichern klicken
Sie auf den Button "Hinzufügen".

Mitarbeiter
...........

Anschliessend tragen Sie die MitarbeiterInnen für alle
Dienststellen ein, indem Sie im Administrationsmenü, Rubrik
"Mitarbeiter" auf "Neueintrag" klicken und im aufgerufenen
Formular die Felder "Vorname", "Name", "Benutzername" (sollte
immer einmalig sein), "Status" (i=im Dienst, a=ausser Dienst),
Rechte (Gruppenzugehörigkeit: bearb=Fallbearbeiter,
verw=Verwaltung, Sekretärin, admin=Administrator, prot=Protokoll
- Berechtigung zum Einsehen der Logprotokolle -)  und die
zugehörige "Stelle" (A, B, C, ....) ausfüllen. Zum Abspeichern
klicken Sie auf den Button "Speichern". Der Benutzernamen muss
immer einmalig sein; man kann aber dieselbe Mitarbeiterin auch
unter jeweils anderem Benutzernamen in verschiedenen
Nutzergruppen mehrfach eintragen (z.B. einmal als Administrator,
einmal als Fachkraft oder als Berechtigte für das Protokoll oder
als Vertretung der Sekretärin).


Start des EBKuS-Servers
-----------------------

Nach einer korrekten und vollständigen Installation wird der
EBKuS-Server automatisch beim Hochfahren des Rechners gestartet
(ebenso wie der Apache-Webserver und der MySQL-Datenbankserver).

**Windows NT/2000/XP**: Für jede installierte EBKuS-Instanz gibt
es einen Windows-Dienst mit dem Namen ``EBKuS-``\ *Instanzname*.
Außerdem gibt es gemeinsam für alle Instanzen den Dienst
``Apache`` und den Dienst ``MySQL``. Alle Dienste müssen im
Zustand ``Gestartet`` sein, damit EBKuS verwendet werden kann. 


Das Starten bzw. Beenden eines Dienstes kann auf verschiedene
Arten erfolgen:

- automatisch beim Neustart bzw. Herunterfahren des Rechners 
- über  ``Start > Einstellungen > Systemsteuerung > Verwaltung >
  Dienste``,
- über das mitgelieferte Skript `dienst.py`_
- über die Kommandozeile, z.B.::

    net start EBKuS-demo
    net stop EBKuS-demo

*Anmerkung*: Alle Dienste müssen den 'Starttyp: Automatisch'
haben, damit sie beim Neustart des Rechners automatisch vom
System gestartet werden (siehe `Windows NT/2000/XP`_ Schritt 9
und `dienst.py`_).


**GNU/Linux**: Für jede installierte EBKuS-Instanz gibt es ein
Skript ``ebkus_``\ *Instanzname* (siehe `ebkus_Instanzname`_) in
``/etc/init.d`` (kann für verschieden Linux-Distributionen
unterschiedlich sein). Damit kann der EBKuS-Server einer Instanz
gestartet bzw. beendet werden. Ähnlich Skripte gibt es auch für
Apache und MySQL (``apache``, ``mysql``). Alle drei
Server-Programme müssen gestartet sein, damit eine EBKuS-Instanz
verwendet werden kann.

Zu Testzwecken und zur Fehlersuche kann der EBKuS-Server einer
Instanz auch direkt mit dem `start.py`_- bzw. `stop.py`_-Skript
gestartet und beendet werden (sowohl unter GNU/Linux als auch
unter Windows NT/2000/XP). Für die Fehlersuche kann es hilfreich
sein, mit der ``--console`` Option zu starten, damit die
Meldungen des EBKuS-Server direkt auf die Konsole geschrieben
werden, anstatt in die Log-Datei (siehe `Konfiguration`_). [Wer
sehr viel Output sehen will, starte mit ``./start.py --console
--debug`` :-)]

Konfiguration des Internetbrowsers
----------------------------------

Die Anwendung EBKuS 3.2 haben wir geprüft mit den Open Source Browsern
Mozilla, Netscape, Firefox und mit dem Internet-Explorer von Microsoft. Der
Interbrowser sollte folgende Einstellungen aufweisen, um mit EBKuS problemlos
zu arbeiten:

- *Cookies*: Cookies müssen aktiviert bzw. für die Webadresse von EBKuS
  zugelassen werden.  
- *Temporäre Internetdateien*: Die aufgerufenen HTML-Seiten werden meistens
  temporär auf der Festplatte gespeichert. Als Anwender kann man einstellen,
  wie der Internetbrowser mit diesen temporären Dateien umgeht. Um
  auszuschliessen, dass er veraltete Dateien aus dem lokalen Zwischenspeicher
  aufruft, sollte man bei den Einstellungen für die temporären Dateien
  bzw. den Cache den Knopf "automatisch" im Internetbrowser von Microsoft
  oder den Knopf "Wenn die Seite veraltet ist" im Mozilla, Netscape aktivieren.
- *SSL*: Um die verschlüsselte Datenübertragung zu gewährleisten, sollte "SSL
  2.0 verwenden" und "SSL 3.0 verwenden" aktiviert sein. Beides ist 
  standardmässig beim MS Internet-Explorer angekreuzt.
- *Verschlüsselter Seiten*: Im MS Internet-Explorer sollte "Verschlüsselte
  Seiten nicht auf der Festplatte speichern" deaktiviert sein.
- *HTTP 1.1. über Proxy verwenden*: Dieses Feature sollte im MS
  Internet-Explorer deaktiviert und "HTTP 1.1 verwenden" angekreuzt sein.

Weiter empfehlen wir, aus Sicherheitsgründen folgende Hinweise bei der Arbeit
mit dem Internetbrowser zu berücksichtigen:

- *Temporäre Internetdateien*: Arbeiten mehrere Anwender auf einem PC unter
  dem gleichen Benutzernamen, sollte man ankreuzen, dass beim Beenden des
  Browsers alle temporären Dateien gelöscht werden.  
- *Passwortmanager*: Sofern mehrere Anwender auf dem PC unter der gleichen
  Kennung arbeiten, sollte man auf die Speicherung der Passwörter im
  Passwortmanager verzichten.
- *Warnungen*: In Abhängigkeit des gewählten Grades der
  Sicherheitseinstellungen erhält der Anwender Warnhinweise vom Browser,
  z.B. beim Verlassen verschlüsselter Verbindungen etc. Die Anzeigen solcher
  Warnhinweise können im Eigenschaftendialog aktiviert oder deaktiviert
  werden.


Datensicherung
--------------

Mit Hilfe des Skripts `datenbank_sichern.py`_ lässt sich der
Inhalt der Datenbank einer Instanz als Datei sichern. 
Die Backup-Datei ist ein ZIP-Archiv, das sowohl eine
Kopie der Datenbank als SQL-Datei als auch die vom Anwender
hochgeladenen Dokumente (siehe `Aktendokumente`_) enthält. 
Mit dem Skripts `datenbank_initialisieren.py`_ lässt sich der
Zustand einer Instanz aus einem ZIP-Archiv wiederherstellen.

Es empfiehlt sich, regelmäßige Backups zu erstellen, um einem
Datenverlust vorzubeugen. Dies lässt sich mit einem Cron-Job
(GNU/Linux) oder mit 'Geplanten Vorgängen' (Windows NT/2000/XP)
automatisieren.

**GNU/Linux**: Wenn man eine Zeile wie z.B.

::

  25 2 * * * /home/user/ebinst/ebkus/demo/datenbank_sichern.py --zip /home/user/backups

in den crontab einträgt, wird jeden Tag um 2:25h ein Backup der
Instanz ``demo`` in das Verzeichnis ``/home/user/backups``
geschrieben. 

**Windows NT/2000/XP**: Man erstellt eine Batch-Datei, die den
Backup-Befehl enthält, z.B. eine Datei ``C:\backup.bat`` mit der Zeile::

  C:\ebkus_installation\ebkus\demo\datenbank_sichern.py --zip C:\Backups

Über ``Start > Einstellungen > Systemsteuerung > Geplante
Vorgänge`` erstellt man eine neue Task, die die Batch-Datei
regelmäßig ausführt. Alternativ kann man den
``at``-Befehl auf der Kommandozeile verwenden::

  at 2:25 /every:di,mi,do,fr,sa C:\backup.bat

Damit wird die Batch-Datei Dienstags bis Samstags um 2:25
ausgeführt. 


Aufbewahrungsfrist von Akten
----------------------------

Es können vom EBKuS-Administrator alle Akten, welche vor einer
bestimmten Anzahl von Monaten geschlossen wurden, gelöscht werden
(siehe `Das Hauptmenü 'Administration'`_). Die Aufbewahrungsfrist
ist für die jeweilige Erziehungsberatungsstelle (= Instanz) in
der Konfiguration von EBKuS einzutragen (`Konfiguration`_). 

.. 
  Die unabhängig geführten statistischen Daten wie die Fachstatistik
  und Bundesjugendhilfestatistik bleiben in der Datenbank erhalten
  und sind für Auswertungen weiter verfügbar.

